<html>
<head>
<title>AddAndUpdateMultipleCustomers.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
AddAndUpdateMultipleCustomers.java</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">com.unitedcoder.homework.week11cubecartproject</span><span class="s0">;</span>

<span class="s0">import </span><span class="s1">org.apache.commons.lang3.StringUtils</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">org.openqa.selenium.By</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">org.openqa.selenium.WebElement</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">org.openqa.selenium.support.ui.Select</span><span class="s0">;</span>

<span class="s0">import </span><span class="s1">java.util.ArrayList</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.util.InputMismatchException</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.util.List</span><span class="s0">;</span>

<span class="s0">public class </span><span class="s1">AddAndUpdateMultipleCustomers </span><span class="s0">extends </span><span class="s1">BaseClass{</span>

    <span class="s2">//Add multiple customers</span>
    <span class="s0">public static void </span><span class="s1">addCustomer(CustomerObject customerObject)  {</span>

        <span class="s2">//Fill general information</span>
        <span class="s1">WebElement customerListLink = driver.findElement(By.linkText(</span><span class="s3">&quot;Customer List&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">customerListLink.click()</span><span class="s0">;</span>

        <span class="s1">WebElement addCustomerLink = driver.findElement(By.xpath(</span><span class="s3">&quot;//a[contains(text(),</span><span class="s0">\&quot;</span><span class="s3">Add Customer</span><span class="s0">\&quot;</span><span class="s3">)]&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">addCustomerLink.click()</span><span class="s0">;</span>

        <span class="s1">WebElement status = driver.findElement(By.xpath(</span><span class="s3">&quot;//img[@rel='#customer_status']&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">status.click()</span><span class="s0">;</span>

        <span class="s1">WebElement title = driver.findElement(By.id(</span><span class="s3">&quot;cust-title&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">title.sendKeys(customerObject.getTitle())</span><span class="s0">;</span>

        <span class="s1">WebElement firstName = driver.findElement(By.name(</span><span class="s3">&quot;customer[first_name]&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">firstName.sendKeys(customerObject.getFirstName())</span><span class="s0">;</span>

        <span class="s1">WebElement lastName = driver.findElement(By.id(</span><span class="s3">&quot;cust-lastname&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">lastName.sendKeys(customerObject.getLastName())</span><span class="s0">;</span>

        <span class="s1">WebElement typeDropdown = driver.findElement(By.id(</span><span class="s3">&quot;cust-type&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">Select selectType = </span><span class="s0">new </span><span class="s1">Select(typeDropdown)</span><span class="s0">;</span>
        <span class="s1">selectType.selectByVisibleText(CustomerObject.CustomerDropdowns.REGISTERED_CUSTOMER.getValue())</span><span class="s0">;</span>

        <span class="s1">WebElement customerNotes = driver.findElement(By.id(</span><span class="s3">&quot;cust-notes&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">customerNotes.sendKeys(customerObject.getCustomerNotes())</span><span class="s0">;</span>

        <span class="s1">WebElement email = driver.findElement(By.id(</span><span class="s3">&quot;cust-email&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">email.sendKeys(customerObject.getEmail())</span><span class="s0">;</span>

        <span class="s1">WebElement phone = driver.findElement(By.id(</span><span class="s3">&quot;cust-phone&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">phone.sendKeys(customerObject.getPhone())</span><span class="s0">;</span>

        <span class="s1">WebElement cellPhone = driver.findElement(By.id(</span><span class="s3">&quot;cust-mobile&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">cellPhone.sendKeys(customerObject.getCellPhone())</span><span class="s0">;</span>

        <span class="s1">WebElement newsletterDropdown = driver.findElement(By.id(</span><span class="s3">&quot;subscription_status&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">Select newsletterStatus = </span><span class="s0">new </span><span class="s1">Select(newsletterDropdown)</span><span class="s0">;</span>
        <span class="s1">List&lt;WebElement&gt; options = newsletterStatus.getOptions()</span><span class="s0">;</span>
        <span class="s0">for </span><span class="s1">(WebElement text : options) {</span>
            <span class="s1">String selectText = text.getText()</span><span class="s0">;</span>
            <span class="s0">if </span><span class="s1">(selectText.equalsIgnoreCase(</span><span class="s3">&quot;Yes&quot;</span><span class="s1">)) {</span>
                <span class="s1">text.click()</span><span class="s0">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s1">WebElement addressesLink = driver.findElement(By.linkText(</span><span class="s3">&quot;Addresses&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">fluentWait(addressesLink</span><span class="s0">,</span><span class="s4">3</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s0">try </span><span class="s1">{</span>
        <span class="s1">WebElement password = driver.findElement(By.id(</span><span class="s3">&quot;cust-password&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">password.sendKeys(customerObject.getPassword())</span><span class="s0">;</span>

        <span class="s1">WebElement confirmPassword = driver.findElement(By.id(</span><span class="s3">&quot;cust-passconf&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">confirmPassword.sendKeys(customerObject.getConfirmPassword())</span><span class="s0">;</span>
            <span class="s0">if </span><span class="s1">(!customerObject.getPassword().equalsIgnoreCase(customerObject.getConfirmPassword())) {</span>
                <span class="s0">throw new </span><span class="s1">InputMismatchException()</span><span class="s0">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span><span class="s0">catch</span><span class="s1">(InputMismatchException i) {</span>
            <span class="s1">System.out.println(</span><span class="s3">&quot;password unmatched, please enter same passwords&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">}</span><span class="s0">finally </span><span class="s1">{</span>
            <span class="s1">addressesLink.click()</span><span class="s0">;</span>
        <span class="s1">}</span>
        <span class="s2">//Fill address information</span>
        <span class="s1">WebElement addAddressLink = driver.findElement(By.cssSelector(</span><span class="s3">&quot;.colorbox.address-form.cboxElement&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">addAddressLink.click()</span><span class="s0">;</span>
        <span class="s1">WebElement description = driver.findElement(By.id(</span><span class="s3">&quot;edit_description&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">fluentWait(description</span><span class="s0">,</span><span class="s4">3</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">description.sendKeys(customerObject.getAddressDescription())</span><span class="s0">;</span>

        <span class="s1">WebElement editTitle = driver.findElement(By.id(</span><span class="s3">&quot;edit_title&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">editTitle.sendKeys(customerObject.getTitle())</span><span class="s0">;</span>

        <span class="s1">WebElement editFirstName = driver.findElement(By.name(</span><span class="s3">&quot;address[first_name][]&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">editFirstName.sendKeys(customerObject.getFirstName())</span><span class="s0">;</span>

        <span class="s1">WebElement editLastName = driver.findElement(By.id(</span><span class="s3">&quot;edit_last_name&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">editLastName.sendKeys(customerObject.getLastName())</span><span class="s0">;</span>

        <span class="s1">WebElement companyName = driver.findElement(By.id(</span><span class="s3">&quot;edit_company_name&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">companyName.sendKeys(customerObject.getCompanyName())</span><span class="s0">;</span>

        <span class="s1">WebElement addressLine1 = driver.findElement(By.name(</span><span class="s3">&quot;address[line1][]&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">WebElement addressLine2 = driver.findElement(By.name(</span><span class="s3">&quot;address[line2][]&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">sleep(</span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s0">if </span><span class="s1">(customerObject.getAddress().length() &gt; </span><span class="s4">35</span><span class="s1">) {</span>
            <span class="s1">addressLine1.sendKeys(StringUtils.substring(customerObject.getAddress()</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">35</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">addressLine2.sendKeys(StringUtils.substring(customerObject.getAddress()</span><span class="s0">, </span><span class="s4">35</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
            <span class="s1">addressLine1.sendKeys(customerObject.getAddress())</span><span class="s0">;</span>
        <span class="s1">}</span>
        <span class="s1">WebElement city = driver.findElement(By.id(</span><span class="s3">&quot;edit_town&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">city.sendKeys(customerObject.getCity())</span><span class="s0">;</span>

        <span class="s1">WebElement countryOption = driver.findElement(By.id(</span><span class="s3">&quot;edit_country&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">Select selectCountry = </span><span class="s0">new </span><span class="s1">Select(countryOption)</span><span class="s0">;</span>
        <span class="s1">selectCountry.selectByVisibleText(customerObject.getCountry())</span><span class="s0">;</span>
        <span class="s1">sleep(</span><span class="s4">2</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">WebElement state = driver.findElement(By.name(</span><span class="s3">&quot;address[state][]&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s0">if</span><span class="s1">(state.getText().equalsIgnoreCase(</span><span class="s3">&quot;-- None --&quot;</span><span class="s1">)){</span>
                <span class="s1">Select select = </span><span class="s0">new </span><span class="s1">Select(state)</span><span class="s0">;</span>
                <span class="s1">select.selectByIndex(</span><span class="s4">3</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">}</span><span class="s0">else </span><span class="s1">{</span>
                <span class="s1">state.sendKeys(customerObject.getState())</span><span class="s0">;</span>
            <span class="s1">}</span>

        <span class="s1">WebElement zipCode = driver.findElement(By.id(</span><span class="s3">&quot;edit_postcode&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">zipCode.sendKeys(customerObject.getZipCode())</span><span class="s0">;</span>

        <span class="s1">WebElement billingAddressCheckBox = driver.findElement(By.name(</span><span class="s3">&quot;address[billing][]&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s0">if </span><span class="s1">(!billingAddressCheckBox.isEnabled()) {</span>
            <span class="s1">billingAddressCheckBox.click()</span><span class="s0">;</span>
        <span class="s1">}</span>
        <span class="s1">WebElement deliveryAddressCheckBox = driver.findElement(By.name(</span><span class="s3">&quot;address[default][]&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s0">if </span><span class="s1">(!deliveryAddressCheckBox.isEnabled()) {</span>
            <span class="s1">deliveryAddressCheckBox.click()</span><span class="s0">;</span>
        <span class="s1">}</span>
        <span class="s1">WebElement addButton = driver.findElement(By.xpath(</span><span class="s3">&quot;//input[@target='address-list']&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">addButton.click()</span><span class="s0">;</span>
        <span class="s2">//Select customer group</span>
        <span class="s1">WebElement customerGroups = driver.findElement(By.linkText(</span><span class="s3">&quot;Customer Groups&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">fluentWait(customerGroups</span><span class="s0">,</span><span class="s4">2</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">customerGroups.click()</span><span class="s0">;</span>

        <span class="s1">WebElement groupType = driver.findElement(By.id(</span><span class="s3">&quot;group-join&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">fluentWait(groupType</span><span class="s0">,</span><span class="s4">2</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">Select selectCustomerGroup = </span><span class="s0">new </span><span class="s1">Select(groupType)</span><span class="s0">;</span>
        <span class="s1">List&lt;WebElement&gt; groups = selectCustomerGroup.getOptions()</span><span class="s0">;</span>
        <span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s0">; </span><span class="s1">i &lt; groups.size()</span><span class="s0">; </span><span class="s1">i++) {</span>
            <span class="s1">String groupValue = groups.get(i).getText()</span><span class="s0">;</span>
            <span class="s0">if </span><span class="s1">(groupValue.equalsIgnoreCase(customerObject.getCustomerGroup())) {</span>
                <span class="s1">groups.get(i).click()</span><span class="s0">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
       <span class="s1">WebElement saveButton= driver.findElement(By.name(</span><span class="s3">&quot;save&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">saveButton.click()</span><span class="s0">;</span>
    <span class="s1">}</span>
        <span class="s2">//verify add customer successful</span>
        <span class="s0">public static void </span><span class="s1">verifyCustomerAddedSuccessfully(CustomerObject customerObject){</span>
            <span class="s1">WebElement successMessage=driver.findElement(By.xpath</span>
                    <span class="s1">(</span><span class="s3">&quot;//*[contains(text(),'Customer successfully added.')]&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s0">if</span><span class="s1">(successMessage.isDisplayed()){</span>
                <span class="s1">System.out.println(customerObject.getCustomerGroup()+</span><span class="s3">&quot; &quot;</span><span class="s1">+customerObject.getTitle()+</span><span class="s3">&quot; &quot;</span><span class="s1">+</span>
                        <span class="s1">customerObject.getLastName() +</span><span class="s3">&quot; added successfully&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">}</span><span class="s0">else</span><span class="s1">{</span>
                <span class="s1">System.out.println(</span><span class="s3">&quot;Add customer Failed!!!&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>


        <span class="s0">public static void </span><span class="s1">updateCustomer(CustomerObject customerObject){</span>

            <span class="s1">WebElement customerListLink = driver.findElement(By.linkText(</span><span class="s3">&quot;Customer List&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">fluentWait(customerListLink</span><span class="s0">,</span><span class="s4">2</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">customerListLink.click()</span><span class="s0">;</span>

            <span class="s1">WebElement searchCustomerMenu= driver.findElement(By.linkText(</span><span class="s3">&quot;Search Customers&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">searchCustomerMenu.click()</span><span class="s0">;</span>
            <span class="s1">WebElement searchCustomerBar= driver.findElement(By.id(</span><span class="s3">&quot;customer_id&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">searchCustomerBar.click()</span><span class="s0">;</span>
            <span class="s1">searchCustomerBar.sendKeys(customerObject.getEmail())</span><span class="s0">;</span>
            <span class="s1">WebElement goButton= driver.findElement(By.xpath(</span><span class="s3">&quot;//*[@id=</span><span class="s0">\&quot;</span><span class="s3">sidebar_content</span><span class="s0">\&quot;</span><span class="s3">]/div[1]/form/input[3]&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">goButton.click()</span><span class="s0">;</span>
            <span class="s1">WebElement editIcon= driver.findElement(By.cssSelector(</span><span class="s3">&quot;.fa.fa-pencil-square-o&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">editIcon.click()</span><span class="s0">;</span>

            <span class="s1">WebElement customerNotes = driver.findElement(By.id(</span><span class="s3">&quot;cust-notes&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">customerNotes.clear()</span><span class="s0">;</span>
            <span class="s1">customerNotes.sendKeys(</span><span class="s3">&quot;New customer note &quot;</span><span class="s1">+System.currentTimeMillis())</span><span class="s0">;</span>
            <span class="s1">WebElement saveButton= driver.findElement(By.name(</span><span class="s3">&quot;save&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">saveButton.click()</span><span class="s0">;</span>
            <span class="s1">WebElement successMessage= driver.findElement(By.xpath(</span><span class="s3">&quot;//div[text()='Customer successfully updated.']&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s0">if </span><span class="s1">(successMessage.isDisplayed()){</span>
                <span class="s1">System.out.println(</span><span class="s3">&quot;Customer &quot;</span><span class="s1">+customerObject.getLastName()+</span><span class="s3">&quot;  updated successfully&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">public static void </span><span class="s1">deleteCustomer(CustomerObject customerObject){</span>
            <span class="s1">WebElement customerListLink = driver.findElement(By.linkText(</span><span class="s3">&quot;Customer List&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">customerListLink.click()</span><span class="s0">;</span>

            <span class="s2">//Delete with search function</span>
          <span class="s2">/*  WebElement searchCustomerMenu= driver.findElement(By.linkText(&quot;Search Customers&quot;)); 
            searchCustomerMenu.click(); 
            WebElement searchCustomerBar= driver.findElement(By.id(&quot;customer_id&quot;)); 
            searchCustomerBar.click(); 
            searchCustomerBar.sendKeys(customerObject.getEmail()); 
            WebElement goButton= driver.findElement(By.xpath(&quot;//*[@id=\&quot;sidebar_content\&quot;]/div[1]/form/input[3]&quot;)); 
            goButton.click(); 
            WebElement deleteIcon= driver.findElement (By.xpath(String.format (&quot;//td[text()='%s']//parent::td//following-sibling::td//*[@title='Delete']&quot;,customerObject.getEmail()))); 
            deleteIcon.click(); 
            driver.switchTo().alert().accept();*/</span>

            <span class="s2">//Delete by select multiple customers</span>
            <span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">1</span><span class="s0">; </span><span class="s1">i &lt;= </span><span class="s4">3</span><span class="s0">; </span><span class="s1">i++) {</span>
                <span class="s1">WebElement multiCustomerCheckBox = driver.findElement(By.xpath(String.format(</span><span class="s3">&quot;//*[@id=</span><span class="s0">\&quot;</span><span class="s3">customer-list</span><span class="s0">\&quot;</span><span class="s3">]/table[2]/tbody/tr[%d]/td[1]/div&quot;</span><span class="s0">, </span><span class="s1">i)))</span><span class="s0">;</span>
                <span class="s1">multiCustomerCheckBox.click()</span><span class="s0">;</span>
            <span class="s1">}</span>
            <span class="s1">WebElement deleteIcon= driver.findElement(By.xpath(</span><span class="s3">&quot;//*[@id=</span><span class="s0">\&quot;</span><span class="s3">customer-list</span><span class="s0">\&quot;</span><span class="s3">]/table[2]/tbody/tr[1]/td[8]/a[3]&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s1">deleteIcon.click()</span><span class="s0">;</span>
            <span class="s1">driver.switchTo().alert().accept()</span><span class="s0">;</span>
            <span class="s1">driver.switchTo().alert().accept()</span><span class="s0">;</span>

            <span class="s1">WebElement verifyDeleteSuccess= driver.findElement(By.xpath(</span><span class="s3">&quot;//div[contains(text(),</span><span class="s0">\&quot;</span><span class="s3">successfully deleted.</span><span class="s0">\&quot;</span><span class="s3">)]&quot;</span><span class="s1">))</span><span class="s0">;</span>
            <span class="s0">if </span><span class="s1">(verifyDeleteSuccess.isDisplayed()) {</span>
                <span class="s1">System.out.println(</span><span class="s3">&quot;Some or all selected Customer successfully deleted.&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">}</span><span class="s0">else</span><span class="s1">{</span>
            <span class="s1">System.out.println(</span><span class="s3">&quot;Delete not successful&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
<span class="s1">}</span>
</pre>
</body>
</html>